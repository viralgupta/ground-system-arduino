{"version":3,"file":"index.js","sources":["../../electron/main/index.ts"],"sourcesContent":["import { app, BrowserWindow, shell, ipcMain, dialog } from \"electron\";\r\nimport { createRequire } from \"node:module\";\r\nimport { fileURLToPath } from \"node:url\";\r\nimport path from \"node:path\";\r\nimport os from \"node:os\";\r\nimport { update } from \"./update\";\r\n\r\nconst require = createRequire(import.meta.url);\r\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\r\n\r\nprocess.env.APP_ROOT = path.join(__dirname, \"../..\");\r\n\r\nexport const MAIN_DIST = path.join(process.env.APP_ROOT, \"dist-electron\");\r\nexport const RENDERER_DIST = path.join(process.env.APP_ROOT, \"dist\");\r\nexport const VITE_DEV_SERVER_URL = process.env.VITE_DEV_SERVER_URL;\r\n\r\nprocess.env.VITE_PUBLIC = VITE_DEV_SERVER_URL\r\n  ? path.join(process.env.APP_ROOT, \"public\")\r\n  : RENDERER_DIST;\r\n\r\n// Disable GPU Acceleration for Windows 7\r\nif (os.release().startsWith(\"6.1\")) app.disableHardwareAcceleration();\r\n\r\n// Set application name for Windows 10+ notifications\r\nif (process.platform === \"win32\") app.setAppUserModelId(app.getName());\r\n\r\nif (!app.requestSingleInstanceLock()) {\r\n  app.quit();\r\n  process.exit(0);\r\n}\r\n\r\nlet win: BrowserWindow | null = null;\r\nconst preload = path.join(__dirname, \"../preload/index.mjs\");\r\nconst indexHtml = path.join(RENDERER_DIST, \"index.html\");\r\n\r\nconsole.log(\"preload\", preload);\r\n\r\nasync function createWindow() {\r\n  win = new BrowserWindow({\r\n    title: \"Main window\",\r\n    icon: path.join(process.env.VITE_PUBLIC, \"favicon.ico\"),\r\n    webPreferences: {\r\n      preload: preload,\r\n      // Warning: Enable nodeIntegration and disable contextIsolation is not secure in production\r\n      nodeIntegration: true,\r\n    },\r\n    minWidth: 1190,\r\n    minHeight: 700,\r\n  });\r\n\r\n  if (VITE_DEV_SERVER_URL) {\r\n    win.loadURL(VITE_DEV_SERVER_URL);\r\n    // win.webContents.openDevTools()\r\n  } else {\r\n    win.loadFile(indexHtml);\r\n  }\r\n\r\n  // // Auto update\r\n  // update(win);\r\n}\r\n\r\napp.whenReady().then(()=>{\r\n  ipcMain.handle(\"dialog:openSave\", async () => {\r\n    if (!win) return;\r\n    const currentDate = new Date();\r\n    const options1: Intl.DateTimeFormatOptions = {\r\n      day: \"2-digit\",\r\n      month: \"2-digit\",\r\n      year: \"numeric\",\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n      hour12: true,\r\n      timeZone: \"Asia/Kolkata\",\r\n    };\r\n    const rawFormattedDate = currentDate.toLocaleString(\"en-IN\", options1).replace(/[^\\d]/g, \"\");\r\n    const formattedDate = rawFormattedDate.substring(0, 2) + \"-\" + rawFormattedDate.substring(2, 4) + \"-\" + rawFormattedDate.substring(4, 8) + \"_\" + rawFormattedDate.substring(8, 10) + \"-\" + rawFormattedDate.substring(10, 12);\r\n    const {filePath} = await dialog.showSaveDialog(win, {title: \"Save Exported Data\", defaultPath: `${formattedDate}`, filters: [{name: \"XLSX File\", extensions: [\"xlsx\"]}]})\r\n    return filePath == \"\" ? null : filePath;\r\n  })\r\n  createWindow();\r\n});\r\n\r\napp.on(\"before-quit\", () => {\r\n  if (win) win.webContents.send(\"close-port\");\r\n})\r\n\r\napp.on(\"window-all-closed\", () => {\r\n  win = null;\r\n  app.quit();\r\n});\r\n\r\napp.on(\"activate\", () => {\r\n  const allWindows = BrowserWindow.getAllWindows();\r\n  if (allWindows.length) {\r\n    allWindows[0].focus();\r\n  } else {\r\n    createWindow();\r\n  }\r\n});\r\n"],"names":[],"mappings":";;;;;AAOgB,cAAc,YAAY,GAAG;AAC7C,MAAM,YAAY,KAAK,QAAQ,cAAc,YAAY,GAAG,CAAC;AAE7D,QAAA,IAAY,WAAW,KAAK,KAAK,WAAW,OAAO;AAE5C,MAAM,YAAY,KAAK,KAAK,QAAA,IAAY,UAAU,eAAe;AACjE,MAAM,gBAAgB,KAAK,KAAK,QAAA,IAAY,UAAU,MAAM;AACtD,MAAA,sBAAsB,QAAY,IAAA;AAE/C,QAAA,IAAY,cAAc,sBACtB,KAAK,KAAK,QAAY,IAAA,UAAU,QAAQ,IACxC;AAGJ,IAAI,GAAG,QAAA,EAAU,WAAW,KAAK;AAAG,MAAI,4BAA4B;AAGpE,IAAI,QAAQ,aAAa;AAAa,MAAA,kBAAkB,IAAI,QAAS,CAAA;AAErE,IAAI,CAAC,IAAI,6BAA6B;AACpC,MAAI,KAAK;AACT,UAAQ,KAAK,CAAC;AAChB;AAEA,IAAI,MAA4B;AAChC,MAAM,UAAU,KAAK,KAAK,WAAW,sBAAsB;AAC3D,MAAM,YAAY,KAAK,KAAK,eAAe,YAAY;AAEvD,QAAQ,IAAI,WAAW,OAAO;AAE9B,eAAe,eAAe;AAC5B,QAAM,IAAI,cAAc;AAAA,IACtB,OAAO;AAAA,IACP,MAAM,KAAK,KAAK,QAAA,IAAY,aAAa,aAAa;AAAA,IACtD,gBAAgB;AAAA,MACd;AAAA;AAAA,MAEA,iBAAiB;AAAA,IACnB;AAAA,IACA,UAAU;AAAA,IACV,WAAW;AAAA,EAAA,CACZ;AAED,MAAI,qBAAqB;AACvB,QAAI,QAAQ,mBAAmB;AAAA,EAAA,OAE1B;AACL,QAAI,SAAS,SAAS;AAAA,EACxB;AAIF;AAEA,IAAI,UAAA,EAAY,KAAK,MAAI;AACf,UAAA,OAAO,mBAAmB,YAAY;AAC5C,QAAI,CAAC;AAAK;AACJ,UAAA,kCAAkB;AACxB,UAAM,WAAuC;AAAA,MAC3C,KAAK;AAAA,MACL,OAAO;AAAA,MACP,MAAM;AAAA,MACN,MAAM;AAAA,MACN,QAAQ;AAAA,MACR,QAAQ;AAAA,MACR,UAAU;AAAA,IAAA;AAEN,UAAA,mBAAmB,YAAY,eAAe,SAAS,QAAQ,EAAE,QAAQ,UAAU,EAAE;AAC3F,UAAM,gBAAgB,iBAAiB,UAAU,GAAG,CAAC,IAAI,MAAM,iBAAiB,UAAU,GAAG,CAAC,IAAI,MAAM,iBAAiB,UAAU,GAAG,CAAC,IAAI,MAAM,iBAAiB,UAAU,GAAG,EAAE,IAAI,MAAM,iBAAiB,UAAU,IAAI,EAAE;AACtN,UAAA,EAAC,aAAY,MAAM,OAAO,eAAe,KAAK,EAAC,OAAO,sBAAsB,aAAa,GAAG,aAAa,IAAI,SAAS,CAAC,EAAC,MAAM,aAAa,YAAY,CAAC,MAAM,GAAE,EAAA,CAAE;AACjK,WAAA,YAAY,KAAK,OAAO;AAAA,EAAA,CAChC;AACY;AACf,CAAC;AAED,IAAI,GAAG,eAAe,MAAM;AACtB,MAAA;AAAS,QAAA,YAAY,KAAK,YAAY;AAC5C,CAAC;AAED,IAAI,GAAG,qBAAqB,MAAM;AAC1B,QAAA;AACN,MAAI,KAAK;AACX,CAAC;AAED,IAAI,GAAG,YAAY,MAAM;AACjB,QAAA,aAAa,cAAc;AACjC,MAAI,WAAW,QAAQ;AACV,eAAA,CAAC,EAAE;EAAM,OACf;AACQ;EACf;AACF,CAAC;"}